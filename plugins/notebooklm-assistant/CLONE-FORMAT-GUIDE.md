# 智能文档格式克隆功能使用指南

## 📖 功能概述

**智能文档格式克隆**是 NotebookLM Assistant 的新增核心功能,专为智能建造实施方案、申报资料等标准化文档生成而设计。

### 核心价值

- ✅ **格式精确复制**: 完全保持参考文档的样式、字体、段落格式
- ✅ **内容智能生成**: 从知识库自动提取相关技术内容
- ✅ **降低查重率**: 通过多样化改写技术,查重率控制在15-20%
- ✅ **人机协同**: 关键项目信息由用户提供,描述性内容AI生成
- ✅ **可重复生成**: 每次生成内容都不同,适合生成多个版本

---

## 🚀 快速开始

### 1. 准备工作

#### 步骤1.1: 准备参考文档

准备一份标准的Word文档(.docx)作为格式模板,例如:
- `智能建造实施方案-模板.docx`
- `申报资料-模板.docx`
- `技术方案-模板.docx`

**参考文档应包含**:
- 完整的章节结构(如:一、项目概述; 二、技术方案...)
- 标准的排版格式(字体、字号、行间距、页边距等)
- 可以包含占位符字段(如:[项目名称]、______等)

#### 步骤1.2: 准备知识库文档

将相关的技术文档添加到知识库,例如:
- BIM技术实施方案.pdf
- 智慧工地管理办法.docx
- 项目可行性研究报告.pdf
- 施工组织设计.doc
- 质量安全管理制度.pdf

**知识库文档要求**:
- 格式支持: PDF、Word、Excel、PowerPoint、Markdown、纯文本
- 内容要求: 包含BIM、智慧工地、施工管理等相关内容
- 数量建议: 至少10-20份文档,内容越丰富生成效果越好

#### 步骤1.3: 初始化知识库

```bash
# 运行初始化命令
/notebook-init

# 按提示输入:
# - 知识库名称: 智能建造技术资料库
# - 文档源路径: /path/to/your/documents
```

---

### 2. 基本使用流程

#### 步骤2.1: 运行克隆命令

```bash
/notebook-clone-format /path/to/智能建造实施方案-模板.docx
```

#### 步骤2.2: 等待文档解析

系统会自动:
- 解析参考文档的结构和格式
- 识别章节和需要的数据类型
- 统计文档信息(字数、页数、章节数等)

**预计耗时**: 5-10秒

**输出示例**:
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 Phase 1: 参考文档结构分析完成
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📊 文档统计:
- 章节数: 6 个
- 一级标题: 6 个
- 二级标题: 15 个
- 总字数: 5,432 字

📐 格式信息:
- 标题字体: 黑体 22号 加粗
- 正文字体: 仿宋_GB2312 16号
- 行间距: 1.5倍
- 页边距: 上下2.54cm, 左右3.18cm
```

#### 步骤2.3: 提供项目信息

系统会交互式询问必需的项目信息:

```
💬 根据参考文档分析,我需要以下信息:

🔴 必需字段(请务必提供):
1. 项目名称: ___________
2. 建设地点: ___________
3. 建设单位: ___________

🟡 可选字段(可留空,我将从知识库推断):
4. 项目规模: ___________
5. 建设工期: ___________
6. 投资金额: ___________
```

**填写示例**:
```
项目名称: 苏州工业园区智能建造示范项目
建设地点: 江苏省苏州市工业园区星湖街
建设单位: 苏州一建集团有限公司
项目规模: (留空,AI从知识库推断)
建设工期: (留空,AI从知识库推断)
投资金额: (留空,AI从知识库推断)
```

#### 步骤2.4: 等待智能检索和生成

系统会自动:
1. 从知识库检索相关文档(耗时: 30-60秒)
2. 提取和整合内容(耗时: 30-60秒)
3. 执行多样化改写(耗时: 20-30秒)
4. 生成Word文档(耗时: 10-20秒)

**总耗时**: 约3-5分钟

**进度输出**:
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 Phase 3: 智能检索知识库数据
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔍 正在检索第 1 章: 一、项目概述
✅ 第 1 章检索完成: 找到 3 份相关文档

🔍 正在检索第 2 章: 二、BIM技术应用方案
✅ 第 2 章检索完成: 找到 5 份相关文档

...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 Phase 4: 内容多样化改写(降查重)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✍️  正在改写第 1 章...
✅ 第 1 章改写完成
   - 同义替换: 34 处
   - 句式重组: 12 处
   - 预估相似度: 18%

...
```

#### 步骤2.5: 查看生成结果

生成完成后,会输出详细的完成信息:

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎉 文档生成完成!
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📄 输出文档: 苏州工业园区智能建造示范项目-实施方案-20251106.docx

📊 文档统计:
   - 总字数: 6,523 字
   - 章节数: 6 章
   - 页数估算: ~12 页
   - 引用文档: 18 份

🔍 查重率预估: 15-18% (目标 <20%)

📁 输出文件位置:
   notebooklm-outputs/
   ├── 苏州工业园区智能建造示范项目-实施方案-20251106.docx
   ├── 苏州工业园区智能建造示范项目-实施方案-20251106.md
   └── 苏州工业园区智能建造示范项目-实施方案-审阅报告.md
```

---

## 📋 审阅和使用生成文档

### 1. 打开Word文档

```bash
# macOS
open notebooklm-outputs/项目名称-实施方案-20251106.docx

# Windows
start notebooklm-outputs/项目名称-实施方案-20251106.docx

# Linux
xdg-open notebooklm-outputs/项目名称-实施方案-20251106.docx
```

### 2. 重点审阅项目

根据审阅报告,重点检查以下内容:

#### 🔴 必须审阅项

1. **项目特定信息**
   - 项目名称、地点、单位是否准确
   - 项目规模(如果从知识库推断)是否合理
   - 建设工期是否符合实际

2. **技术参数**
   - BIM软件名称和版本是否符合项目要求
   - 技术路线是否适合本项目
   - 设备和系统配置是否合理

3. **数值数据**
   - 投资金额是否准确
   - 建筑面积、层数等数据是否正确
   - 工期、人员配置等数字是否合理

#### 🟡 建议审阅项

1. **专业术语使用**
   - 行业术语表达是否规范
   - 技术标准引用是否准确

2. **内容完整性**
   - 是否覆盖所有必需章节
   - 内容是否符合申报要求

3. **格式细节**
   - 页眉页脚(如需要)
   - 目录(如需要)
   - 图表(如需要)

### 3. 必要修改

根据审阅结果,在Word中直接修改:
- 调整不准确的技术参数
- 补充项目特定信息
- 优化部分表达
- 添加图表或照片(如需要)

### 4. 导出PDF(可选)

```bash
# 使用LibreOffice转换
soffice --headless --convert-to pdf "项目名称-实施方案-20251106.docx" --outdir notebooklm-outputs/

# 或在Word中:文件 → 另存为 → PDF
```

---

## 🎯 高级使用技巧

### 1. 生成多个不同版本

如需生成多份互不相同的文档(例如多个项目共用同一模板):

```bash
# 第1次生成
/notebook-clone-format ./templates/智能建造实施方案-模板.docx
# 输入项目A信息...

# 第2次生成
/notebook-clone-format ./templates/智能建造实施方案-模板.docx
# 输入项目B信息...

# 第3次生成
/notebook-clone-format ./templates/智能建造实施方案-模板.docx
# 输入项目C信息...
```

**特点**:
- 每次生成的内容都不同(多样化改写)
- 3份文档互相查重率约30-40%
- 格式完全一致

### 2. 批量生成(未来功能)

未来版本将支持:
```bash
/notebook-clone-format ./templates/模板.docx --batch 3
```
一次生成3份不同版本的文档。

### 3. 自定义改写强度(未来功能)

未来版本将支持调整改写强度:
```bash
/notebook-clone-format ./templates/模板.docx --diversity high
```
- `low`: 查重率25-30%(改写较少)
- `medium`: 查重率20-25%(默认)
- `high`: 查重率15-20%(改写最多)

### 4. 指定保留术语(未来功能)

```bash
/notebook-clone-format ./templates/模板.docx --preserve "BIM,智慧工地,装配式"
```

---

## 🔍 查重率控制技术

### 多样化改写的5种策略

#### 1. 同义词替换(Synonym Replacement)

**原理**: 使用建筑行业专业同义词词典,智能替换动词、名词、形容词。

**示例**:
```
原文: "本项目采用BIM技术进行三维建模,有效提高施工效率。"
改写: "本工程运用BIM技术开展立体化建模,有效提升施工效能。"

替换记录:
- 项目 → 工程
- 采用 → 运用
- 进行 → 开展
- 提高 → 提升
- 效率 → 效能
```

**保护机制**:
- 专业术语(BIM、智慧工地)不替换
- 技术标准(GB、JGJ)不替换
- 数值数据不替换

#### 2. 句式重组(Sentence Restructuring)

**原理**: 改变句子结构,包括拆分、合并、倒装等。

**示例**:
```
原文: "本项目位于苏州市工业园区,总建筑面积50000平方米,建设工期24个月。"

改写A(拆分):
"本项目位于苏州市工业园区。总建筑面积50000平方米。建设工期24个月。"

改写B(倒装):
"建设工期24个月的本项目,总建筑面积50000平方米,位于苏州市工业园区。"

改写C(合并):
"位于苏州市工业园区的本项目,建筑面积50000平方米,计划工期24个月。"
```

#### 3. 段落重构(Paragraph Reconstruction)

**原理**: 调整段落内句子的顺序,或合并/拆分句子。

**示例**:
```
原段落: A句 + B句 + C句 + D句

重构方式1: C句(改写) + A句(改写) + D句(改写) + B句(改写)
重构方式2: 合并A+B句 + 扩展C句 + D句(改写)
```

#### 4. 表达方式变换(Expression Variation)

**原理**: 使用不同的表达方式传达相同的意思。

**示例**:
```
原文: "采用先进的BIM技术"
改写: "引入BIM建筑信息模型技术"

原文: "提高施工效率"
改写: "提升工程建设效能"

原文: "加强质量管理"
改写: "强化工程质量管控"
```

#### 5. 数值表达多样化(Numerical Variation)

**原理**: 改变数值的表达形式,但不改变数值本身。

**示例**:
```
50000平方米 → 5万平方米 / 50000㎡ / 五万平方米
24个月 → 两年 / 24月 / 二十四个月
2.5亿元 → 2.5亿 / 25000万元
```

---

## ⚠️ 注意事项与限制

### 法律合规性

1. **知识产权**
   - 参考文档应为合法拥有或授权使用
   - 知识库文档应为项目相关合法资料
   - 生成文档的知识产权归用户所有

2. **内容准确性**
   - AI生成内容可能存在不准确之处
   - 技术参数、工期、金额等必须人工核实
   - 建议由专业人员审阅后使用

3. **使用场景**
   - 不得用于欺诈、造假等违法用途
   - 涉及资质、合同的内容需严格核实
   - 申报资料应符合相关法规要求

### 查重率说明

1. **预估值与实际值**
   - 预估查重率: 15-20%
   - 实际查重率可能略有差异
   - 受查重工具算法影响

2. **影响因素**
   - 专业术语较多可能提高查重率
   - 行业标准表述较固定
   - 数值数据不改写

3. **建议**
   - 使用专业查重工具验证
   - 必要时人工调整部分内容
   - 生成多个版本交叉使用

### 技术限制

1. **文档格式**
   - 仅支持.docx格式参考文档
   - 不支持.doc格式(Office 2003及更早)
   - 复杂格式可能部分丢失

2. **知识库要求**
   - 至少需要10-20份相关文档
   - 文档内容应覆盖参考文档的主题
   - 文档质量影响生成效果

3. **性能**
   - 小型文档(5-10页): 2-3分钟
   - 中型文档(10-20页): 3-5分钟
   - 大型文档(20-30页): 5-8分钟

---

## 🔧 故障排除

### 问题1: 参考文档解析失败

**现象**:
```
❌ 错误: 无法解析参考文档
```

**可能原因**:
- 文档格式不兼容或损坏
- 文档加密或受保护
- 文档路径不正确

**解决方案**:
1. 确认文档为.docx格式
2. 用Word打开并另存为新文件
3. 检查文档是否加密,如是则解除保护
4. 确认文件路径正确且文件存在

### 问题2: 知识库检索结果过少

**现象**:
```
⚠️  第 2 章检索完成: 仅找到 1 份相关文档
```

**可能原因**:
- 知识库文档不足
- 文档主题与参考文档不匹配
- 索引未更新

**解决方案**:
1. 添加更多相关技术文档
2. 运行`/notebook-index`重建索引
3. 手动提供更多可选字段信息

### 问题3: 生成文档格式错乱

**现象**:
- 字体不一致
- 段落格式不正确
- 页边距错误

**可能原因**:
- 参考文档格式过于复杂
- 样式定义不完整
- docx库版本问题

**解决方案**:
1. 使用格式较简单的参考文档
2. 在Word中手动调整格式
3. 检查docx库版本: `npm list docx`

### 问题4: 查重率高于预期

**现象**:
查重率25-30%,高于目标20%

**可能原因**:
- 专业术语过多
- 改写强度不够
- 行业标准表述固定

**解决方案**:
1. 再次运行命令生成新版本
2. 人工调整部分段落表达
3. 联系开发者调整改写参数(未来版本支持)

---

## 💡 最佳实践

### 1. 参考文档准备

**推荐做法**:
- 使用行业标准模板
- 章节结构清晰明确
- 格式统一规范
- 包含占位符字段

**避免**:
- 过于复杂的格式(多栏、嵌套表格)
- 大量图片和图表
- 特殊字体和样式

### 2. 知识库管理

**推荐做法**:
- 定期更新知识库文档
- 文档命名清晰(如:"BIM技术方案.pdf")
- 按主题分类存放
- 定期运行`/notebook-index`

**避免**:
- 文档过时或不相关
- 文件名模糊(如:"文档1.pdf")
- 重复或冲突的内容

### 3. 信息提供

**推荐做法**:
- 必需字段务必填写完整
- 数值数据精确填写
- 专有名词使用全称

**避免**:
- 必需字段留空
- 使用模糊表述(如:"大约"、"左右")
- 缩写或简称(除非行业通用)

### 4. 文档审阅

**推荐做法**:
- 重点审阅审阅报告标注的必需审阅项
- 核对所有数值数据
- 检查技术参数是否符合项目实际
- 使用专业查重工具验证

**避免**:
- 跳过审阅直接使用
- 忽略数值数据检查
- 过度依赖AI生成内容

---

## 📞 获取帮助

### 查看帮助文档

```bash
/notebook-help
```

### 查看审阅报告

生成完成后,查看审阅报告了解详细信息:
```
notebooklm-outputs/项目名称-实施方案-审阅报告.md
```

### 常见命令

```bash
# 重新初始化知识库
/notebook-init

# 更新文档索引
/notebook-index

# 测试问答功能
/notebook-ask BIM技术有哪些应用场景?
```

### 联系开发团队

遇到技术问题:
1. 查看插件README.md
2. 查看CLAUDE.md开发文档
3. 提交Issue到GitHub仓库

---

## 📊 版本历史

### v1.0.0 (2025-11-06)

**新增功能**:
- ✅ 智能文档格式克隆命令(`/notebook-clone-format`)
- ✅ 多样化改写引擎(5种策略)
- ✅ 格式精确分析器
- ✅ 交互式信息收集
- ✅ 查重率控制(<20%)

**技术特性**:
- 支持OOXML格式深度解析
- 同义词词典(建筑行业专用)
- 句式重组算法
- 段落重构引擎
- 数值表达多样化

---

## 🎓 学习资源

### 相关文档

1. **核心命令文档**
   - `commands/notebook-clone-format.md` - 完整命令说明

2. **Skills文档**
   - `skills/content-diversifier/SKILL.md` - 多样化改写引擎
   - `skills/format-analyzer/SKILL.md` - 格式分析器

3. **帮助文档**
   - `commands/notebook-help.md` - 所有命令说明

### 建筑行业资源

- 《建设工程文件归档规范》GB/T 50328-2014
- 《建筑工程施工质量验收统一标准》GB 50300-2013
- 智能建造发展相关政策文档

---

**NotebookLM Assistant - 智能文档格式克隆**
**版本**: v1.0.0
**最后更新**: 2025-11-06
**作者**: NotebookLM Assistant Team
