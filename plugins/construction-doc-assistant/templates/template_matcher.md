# 报告模板匹配辅助文档

这个文档为Claude提供模板匹配和内容生成的详细指导。

## 一、模板智能匹配算法

### 1.1 关键词匹配（权重40%）

统计文档中关键词出现频率，计算每个模板的关键词匹配度：

**试点项目报告**关键词：
- 高权重（10分）：试点、示范、申报、评审
- 中权重（5分）：智能建造、创新、成效、推广
- 低权重（2分）：应用、技术、管理

**专项技术报告**关键词：
- 高权重（10分）：BIM、机器人、技术方案、智能装备
- 中权重（5分）：应用、实施、参数、数据
- 低权重（2分）：效率、质量、成本

**验收汇报材料**关键词：
- 高权重（10分）：验收、检查、评审、竣工
- 中权重（5分）：质量、安全、资料、检测
- 低权重（2分）：合格、达标、符合

**进度分析报告**关键词：
- 高权重（10分）：进度、工期、计划、节点
- 中权重（5分）：偏差、延误、调整、赶工
- 低权重（2分）：完成、百分比、预期

**项目总结报告**关键词：
- 高权重（10分）：总结、年度、阶段、回顾
- 中权重（5分）：成果、经验、效益、评价
- 低权重（2分）：项目、工程、建设

### 1.2 文档类型分析（权重30%）

根据文档类型分布判断报告类型：

| 文档类型组合 | 推荐模板 | 置信度 |
|-------------|---------|--------|
| 实施方案 + PPT汇报 + 应用报告 | 试点项目 | 0.85 |
| 技术方案 + 应用分析 + 数据表格 | 专项技术 | 0.80 |
| 验收记录 + 质量资料 + 检测报告 | 验收汇报 | 0.90 |
| 进度计划 + 施工日志 + 形象进度 | 进度分析 | 0.85 |
| 多类型混合 | 项目总结 | 0.70 |

### 1.3 目录结构分析（权重30%）

分析原文档的目录层级结构：

**试点项目特征**：
- 包含"组织体系"、"实施方案"目录
- 包含多个应用点分类目录
- 有"成效"、"创新"相关目录

**技术报告特征**：
- 按技术类型分类（BIM、机器人等）
- 包含"技术参数"、"应用分析"目录
- 有详细的数据统计目录

**验收材料特征**：
- 按资料分类（质量、安全、技术等）
- 包含"检验批"、"验收记录"目录
- 有"隐蔽工程"、"检测报告"目录

### 1.4 综合判断流程

```
1. 扫描所有文档，提取关键词 → 计算关键词得分（40%权重）
2. 分析文档类型分布 → 计算类型匹配度（30%权重）
3. 分析目录结构特征 → 计算结构相似度（30%权重）
4. 综合得分 = 关键词得分×0.4 + 类型得分×0.3 + 结构得分×0.3
5. 如果最高得分 > 0.6，选择该模板；否则使用"项目总结"默认模板
6. 如果用户指定了模板，直接使用用户选择
```

---

## 二、深度内容提取策略

### 2.1 数据提取原则

**绝对不要的表述**：
- ❌ "文档包含31个表格"
- ❌ "文档有20个章节"
- ❌ "根据关键词提取"
- ❌ "成功读取5个文档"

**应该的表述**：
- ✅ "机器人应用效率提升45%，成本降低28%"
- ✅ "完成7#实验楼主体结构施工，面积15000㎡"
- ✅ "BIM模型协调发现并解决碰撞问题127处"

### 2.2 Word文档提取策略

使用 `parse_word_document` 工具时：

```javascript
// 提取配置
{
  "file_path": "[文档路径]",
  "extract_tables": true,  // 必须true，提取表格
  "keywords": ["效率", "成本", "质量", "数据", "百分比", "提升"]
}

// 提取重点：
1. 包含数字的段落（效率、成本、质量数据）
2. 表格中的关键数值
3. 结论性语句
4. 对比数据
```

**处理示例**：
```
原始表格：
| 作业类型 | 传统方式 | 机器人 | 提升幅度 |
|---------|---------|--------|---------|
| 地面整平 | 1500㎡/天 | 4200㎡/天 | 180% |

提取为：
四轮激光整平机器人作业效率4200㎡/天，相比传统人工1500㎡/天，效率提升180%。
```

### 2.3 Excel文档提取策略

使用 `parse_excel_document` 工具时：

```javascript
{
  "file_path": "[文档路径]",
  "max_rows": 100  // 根据实际调整
}

// 提取重点：
1. 标题行（理解数据含义）
2. 数值列（统计总数、平均值、最大最小值）
3. 时间列（识别时间跨度）
4. 汇总行（通常在最后几行）
```

**处理示例**：
```
原始Excel：37行实施计划数据

提取为：
项目实施计划涵盖8个应用方向、37项具体任务，实施周期为2024年3月至12月，
涉及设计、施工、管理等全过程。重点任务包括：
1. BIM数字化设计（3-5月完成）
2. 智能管理平台上线（6月完成）
3. 建筑机器人应用（7-10月持续）
```

### 2.4 PPT文档提取策略

使用 `parse_powerpoint_document` 工具时：

```javascript
{
  "file_path": "[文档路径]",
  "max_slides": 50,
  "extract_notes": true  // 提取备注
}

// 提取重点：
1. 幻灯片标题（章节结构）
2. 关键数据（图表、数字）
3. 备注内容（详细说明）
4. 总结页内容
```

**处理示例**：
```
原始：24张幻灯片

提取为：
项目汇报材料包含BIM技术应用、智能管理平台、机器人应用三大板块：

【BIM应用板块】（幻灯片3-12）
- 完成全专业BIM建模，模型精度达LOD400
- BIM AI审图发现设计问题58处，提前消除施工隐患
- 基于BIM进行碳排放测算，优化设计降低碳排放12%

【智能管理板块】（幻灯片13-18）
- 建立项目管理平台，集成6大系统
- 实现进度、质量、安全的实时监控
- 数据自动统计，管理效率提升40%
```

### 2.5 组合分析策略

当多个文档互相关联时，进行交叉验证和补充：

```
实施方案（Word）→ 提供总体框架和目标
+
应用报告（Word）→ 提供详细数据和分析
+
实施计划（Excel）→ 提供时间节点和任务分解
+
汇报材料（PPT）→ 提供提炼的核心成果
=
综合报告（深度整合，数据充实）
```

---

## 三、专业报告内容生成规范

### 3.1 封面页生成

```markdown
---
**[项目名称]**

**[报告类型]**

编制单位：[从配置文件读取，如"苏州第一建筑集团有限公司"]
编制日期：[格式：2024年10月15日]

---

| 岗位 | 姓名 | 签名 | 日期 |
|------|------|------|------|
| 编制 | _____ | _____ | _____ |
| 审核 | _____ | _____ | _____ |
| 批准 | _____ | _____ | _____ |

---
```

### 3.2 正文内容规范

#### （1）项目概况部分

**必须包含**：
- 项目名称、地点、规模
- 建设单位、施工单位、监理单位
- 合同工期、合同金额（如有）
- 项目特点

**示例**：
```markdown
## 一、项目概况

### 1.1 基本信息

**项目名称**：苏州一建518地块智能建造项目

**建设地点**：江苏省苏州市工业园区

**建设规模**：总建筑面积约8.5万平方米，其中7#实验楼地下1层、地上12层，
主体结构为框架-剪力墙结构，建筑高度54米。

**参建单位**：
- 建设单位：[单位名称]
- 施工总承包：苏州第一建筑集团有限公司
- 监理单位：[单位名称]
- 设计单位：[单位名称]

**合同工期**：2023年6月1日至2025年6月30日，总工期730天

**项目特点**：本项目作为江苏省智能建造试点项目，在BIM技术应用、建筑机器人
应用、智能管理平台建设等方面进行全面探索和实践。
```

#### （2）技术应用部分

**必须包含**：
- 技术名称和类型
- 应用范围和规模
- **关键数据**（效率、成本、质量）
- 与传统方式对比
- 应用成效

**示例**：
```markdown
### 3.2 四轮激光整平机器人应用

**应用范围**：7#实验楼地下室及1-12层楼面混凝土地面整平作业

**应用规模**：累计作业面积约4.2万平方米

**技术参数**：
- 激光测量精度：±1mm
- 作业幅宽：3.5米
- 整平厚度范围：50-200mm

**应用成效**：

（1）**效率大幅提升**

机器人作业效率达4200㎡/天，传统人工作业效率仅1500㎡/天，效率提升180%。
以7#实验楼为例，传统方式需28天完成，机器人仅需10天，缩短工期18天。

（2）**质量显著改善**

地面平整度达到±2mm，传统人工整平精度为±5mm，精度提升60%。经第三方检测，
合格率100%，优良率达98%，无返工现象。

（3）**成本有效控制**

单位面积综合成本12元/㎡，传统人工成本16.5元/㎡，成本降低27.3%。
整个项目节约成本约18.9万元。

（4）**劳动强度降低**

传统方式需配备作业人员12人，机器人作业仅需3人（1名操作手+2名辅助工），
减少用工9人，降低劳动强度75%。

（以上数据来源于2024年9月编制的《建筑机器人施工应用分析报告》及现场统计数据）
```

#### （3）成效分析部分

**必须包含**：
- 量化数据
- 对比分析
- 经济效益
- 社会效益

**数据呈现方式**：
- 使用具体数字，不使用模糊表述
- 提供对比数据
- 注明数据来源
- 使用表格展示复杂数据

#### （4）创新亮点部分

**必须包含**：
- 创新点描述（技术/管理/模式）
- 创新的独特性
- 创新带来的价值
- 与行业现状对比

### 3.3 文档来源引用规范

**引用格式**：
```markdown
# ✅ 正确格式
根据《苏州一建518地块智能建造实施方案》（2024年8月编制），本项目总体要求包括...

根据《建筑机器人施工应用分析报告》统计，四轮激光整平机器人累计作业面积达4.2万平方米...

经现场实测和第三方检测数据显示，机器人作业地面平整度达到±2mm...

（注：以上数据来源于项目技术资料及现场统计记录）

# ❌ 错误格式
**来源**: 《智能建造实施方案.docx》(41个章节,48段落,3个表格)
路径: /Volumes/MOVESPEED/projectDocs2/...
成功读取，提取内容完整
```

### 3.4 表格使用规范

**表格使用场景**：
- 数据对比（传统 vs 新技术）
- 进度统计
- 参数列表
- 资源配置

**表格示例**：
```markdown
**表1 建筑机器人应用效果对比**

| 机器人类型 | 应用面积 | 传统效率 | 机器人效率 | 效率提升 | 成本节约 |
|-----------|---------|---------|-----------|---------|---------|
| 四轮激光整平 | 4.2万㎡ | 1500㎡/天 | 4200㎡/天 | 180% | 18.9万元 |
| 履带抹平机 | 3.8万㎡ | 1200㎡/天 | 3500㎡/天 | 192% | 15.6万元 |
| 合计 | 8.0万㎡ | - | - | - | 34.5万元 |
```

### 3.5 附件清单

**不要列出完整文件路径**，使用规范格式：

```markdown
## 附件

本报告相关支撑材料包括：

1. 《苏州一建518地块智能建造实施方案》（2024年8月）
2. 《建筑机器人施工应用分析报告》（2024年9月）
3. 《项目智能建造管理平台应用报告》（2024年7月）
4. 《江苏省智能建造试点项目汇报材料》（PPT，2024年10月）
5. 《项目智能建造实施计划表》（Excel）
6. BIM问题协调报告（6份）
7. 机器人作业数据统计表（31份）
8. 第三方检测报告（15份）

以上材料存档于项目技术资料室，可供查阅。
```

---

## 四、过滤规则清单

### 4.1 必须删除的内容

**完整章节删除**：
- "## 文档读取情况"（包括整个表格和统计）
- "## 报告质量说明"
- "## 数据来源"（如果是技术性描述）
- "### 参考文档列表"（如果包含路径和元数据）

**段落级删除**：
- 包含"成功读取X个文档"
- 包含"文档包含X段落、X章节、X表格"
- 包含"根据关键词提取"
- 包含"解析成功"、"提取完整"
- 包含内部文件路径（/Volumes/...）

### 4.2 必须规范的内容

**来源标注**：
```
❌ **来源**: 《XXX.docx》(27段落,涵盖智能管理平台功能)
✅ 根据《项目智能建造管理平台报告》，平台主要功能包括...
```

**表情符号**：
```
❌ 📊📋🌟💡🎯🔍✨
✅ 仅保留 ✓（正确）、×（错误）或完全不用
```

**数据表述**：
```
❌ 文档包含31个表格，详细记录应用数据
✅ 经统计，机器人累计作业面积8万㎡，效率提升超180%
```

---

## 五、质量检查清单

生成报告后，进行自查：

### 5.1 内容质量
- [ ] 所有章节都有实质性内容（不是空洞描述）
- [ ] 包含具体数据（百分比、数值、对比）
- [ ] 数据有明确来源（但格式规范）
- [ ] 语言专业，符合建筑行业习惯

### 5.2 格式规范
- [ ] 有封面页（项目信息、审批表）
- [ ] 章节结构清晰（一级、二级、三级标题）
- [ ] 表格格式规范
- [ ] 引用格式一致

### 5.3 技术痕迹检查
- [ ] 没有"成功读取X个文档"
- [ ] 没有"文档包含X段落/章节/表格"
- [ ] 没有"根据关键词提取"
- [ ] 没有内部路径（/Volumes/...）
- [ ] 没有过多表情符号（最多2种）
- [ ] 没有"## 文档读取情况"章节
- [ ] 没有"## 报告质量说明"章节

### 5.4 专业性检查
- [ ] 项目参建单位信息完整
- [ ] 专业术语使用正确
- [ ] 数据单位准确
- [ ] 引用格式专业

---

**使用说明**：Claude在执行 construction-summary 命令时，应始终参考本文档的规范和示例，确保生成的报告直接可交付，无需人工二次编辑。
