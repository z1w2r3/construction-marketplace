# 建筑施工资料完整性检查

检查项目资料的完整性,识别缺失文档和问题,支持全面检查和专项检查。

你现在要执行资料完整性检查任务,参数: $ARGUMENTS

## 执行步骤

### 1. 读取项目配置

从 `.claude/CLAUDE-construction.md` 获取:
- 项目名称
- 原文档目录路径
- 项目类型(通用/房建/市政)

使用 Read 工具读取配置文件,如果不存在则提示用户先运行 `/construction-init`。

### 2. 确定检查范围

根据参数确定检查范围:

- **无参数**: 执行全面检查(所有资料类型)
- **有参数**: 执行专项检查
  - 示例: "质量验收资料"
  - 示例: "主体结构验收资料"
  - 示例: "安全管理资料"
  - 示例: "竣工资料"

### 3. 建立应有资料清单

根据项目类型和检查范围,建立应有资料清单。

#### 参考规范
- 《建设工程文件归档规范》GB/T 50328-2014
- 《建筑工程施工质量验收统一标准》GB 50300-2013

#### 资料清单示例(房建项目-质量验收资料)

```
必备资料(高优先级):
1. 地基基础验收记录
2. 主体结构验收记录
3. 装饰装修验收记录
4. 屋面工程验收记录
5. 检验批质量验收记录
6. 分项工程质量验收记录
7. 分部工程质量验收记录

重要资料(中优先级):
1. 隐蔽工程验收记录
2. 施工试验记录
3. 材料合格证
4. 材料复试报告
5. 技术交底记录

补充资料(低优先级):
1. 施工日志
2. 施工照片
3. 视频资料
```

### 4. 扫描并验证实际文档 ⭐ (核心改进)

#### 4.1 扫描文档目录

使用 Bash 工具扫描原文档目录:

```bash
# 扫描特定类型的文档
find "原文档目录" -type f \( -name "*验收*.docx" -o -name "*验收*.pdf" -o -name "*验收*.xlsx" \)

# 统计文档数量
find "原文档目录" -type f -name "*.docx" | wc -l
find "原文档目录" -type f -name "*.xlsx" | wc -l
find "原文档目录" -type f -name "*.pdf" | wc -l
```

#### 4.2 验证文档可读性 ⭐ (新增)

对找到的关键文档进行验证:

```
使用 mcp__construction_doc_processor__validate_document 工具:
- file_path: [文档绝对路径]

验证目的:
1. 确认文档存在且可读
2. 检查文档是否损坏
3. 获取文档基本信息

返回结果:
- valid: true → 文档完整可用 ✅
- valid: false → 文档存在问题 ⚠️
```

#### 4.3 检查文档内容完整性 ⭐ (新增)

对关键文档,不仅检查是否存在,还要检查内容是否完整:

```
例如检查验收记录文档:

1. 使用 mcp__construction_doc_processor__parse_word_document 读取:
   - file_path: [文档路径]
   - include_tables: true

2. 检查必要章节是否存在:
   - 工程概况
   - 验收结论
   - 验收人员签字
   - 日期

3. 检查表格数据是否填写:
   - 检验项目
   - 检验结果
   - 检验人签字

4. 标注文档状态:
   - ✅ 完整: 文档存在且内容完整
   - ⚠️ 部分完整: 文档存在但内容不全(缺少必要章节/签字)
   - ❌ 缺失: 未找到文档
   - 🔧 需修复: 文档损坏或无法读取
```

**检查示例**:
```
文档: 主体结构验收记录.docx

第一步: 验证文档
mcp__construction_doc_processor__validate_document
→ valid: true, 文档可读

第二步: 解析内容
mcp__construction_doc_processor__parse_word_document
→ 成功解析,提取段落和表格

第三步: 检查必要内容
检查清单:
- [ ] 工程名称: ✅ 存在
- [ ] 验收部位: ✅ 存在
- [ ] 验收日期: ⚠️ 未填写
- [ ] 验收结论: ✅ 存在("合格")
- [ ] 参与人员签字: ⚠️ 缺少监理签字

结论: ⚠️ 文档部分完整
建议: 补充验收日期和监理签字
```

#### 4.4 批量验证策略

对于大量文档,使用高效验证策略:

```
策略 1: 分级验证
- 必备资料: 深度检查(验证+解析+内容检查)
- 重要资料: 中度检查(验证+基本信息)
- 补充资料: 浅度检查(仅验证存在性)

策略 2: 优先级排序
- 先检查高优先级资料
- 发现严重问题及时反馈
- 低优先级问题汇总提示

策略 3: 元数据快速检查
对不需要详细检查的文档:
mcp__construction_doc_processor__get_document_metadata:
  - file_path: [文档路径]
快速获取文件大小、修改时间等信息
```

### 5. 对比分析

#### 5.1 建立对比表

对比应有资料与实际资料:

```markdown
| 资料名称 | 优先级 | 应有状态 | 实际状态 | 问题描述 |
|---------|-------|---------|---------|---------|
| 地基基础验收记录 | 🔴 高 | 必备 | ✅ 完整 | 内容完整,已签字 |
| 主体结构验收记录 | 🔴 高 | 必备 | ⚠️ 部分 | 缺少监理签字 |
| 装饰验收记录 | 🔴 高 | 必备 | ❌ 缺失 | 未找到该文档 |
| 隐蔽工程记录-1F | 🟡 中 | 重要 | ✅ 完整 | - |
| 施工日志 | 🟢 低 | 可选 | ⚠️ 部分 | 部分日期缺失 |
```

#### 5.2 识别问题类型

```
问题分类:
1. 完全缺失: 应有文档完全不存在
2. 内容不完整: 文档存在但缺少必要内容
3. 格式问题: 文档损坏或格式错误
4. 命名不规范: 文档存在但命名不符合规范
5. 签字缺失: 文档完整但缺少必要签字
6. 日期缺失: 文档完整但缺少日期信息
```

### 6. 问题分级 ⭐ (增强)

按优先级和严重程度分级:

#### 🔴 高优先级问题(必须立即整改)

```
条件: 必备资料缺失或严重不完整

示例:
- ❌ 地基基础验收记录缺失
- ❌ 主体结构验收记录缺失
- ⚠️ 关键验收记录无验收人签字
- 🔧 核心文档损坏无法读取

影响: 直接影响工程验收和归档
建议: 立即补充或修复
```

#### 🟡 中优先级问题(建议尽快整改)

```
条件: 重要资料缺失或部分不完整

示例:
- ❌ 隐蔽工程记录缺失
- ⚠️ 材料合格证不全
- ⚠️ 部分验收记录缺少日期

影响: 影响资料完整性
建议: 尽快补充完整
```

#### 🟢 低优先级问题(有时间时整改)

```
条件: 补充资料缺失或命名不规范

示例:
- ❌ 施工照片不足
- ⚠️ 施工日志不连续
- 📝 文件命名不规范

影响: 影响资料规范性
建议: 逐步完善
```

### 7. 容错处理

如果文档验证或读取失败:

```
回退策略:
1. 尝试使用 mcp__construction_doc_processor__validate_document 验证
2. 验证失败则尝试 mcp__construction_doc_processor__get_document_metadata
3. 元数据也无法获取则标记为"🔧 需修复"
4. 在报告中明确说明问题和建议

错误提示示例:
"⚠️ 文档 [文件名] 无法验证,可能原因:
  - 文档格式损坏
  - 文件权限不足
  - 文件路径包含特殊字符
建议: 请手动检查该文档,必要时重新创建"
```

### 8. 生成检查报告

使用 Write 工具创建报告,保存到:
```
生成文件/分析报告/资料完整性检查-[范围]-YYYYMMDD-HHMMSS.md
```

#### 报告结构

```markdown
# 建筑施工资料完整性检查报告

> **项目名称**: [从配置读取]
> **检查范围**: [全面检查/专项检查]
> **检查时间**: [时间戳]
> **原文档目录**: [路径]

---

## 📊 检查概况

**统计数据**:
- 应有资料: X 项
- 实际拥有: Y 项 (完整 A 项 + 部分完整 B 项)
- 完全缺失: Z 项
- 资料完整率: (Y/X × 100)%

**问题统计**:
- 🔴 高优先级问题: X 项
- 🟡 中优先级问题: Y 项
- 🟢 低优先级问题: Z 项

---

## 📋 资料清单对比

### 一、质量验收资料

| 序号 | 资料名称 | 优先级 | 应有状态 | 实际状态 | 文件位置 | 问题描述 |
|------|---------|-------|---------|---------|---------|---------|
| 1 | 地基基础验收记录 | 🔴 高 | 必备 | ✅ 完整 | 验收资料/地基.docx | 内容完整,已签字 |
| 2 | 主体结构验收记录 | 🔴 高 | 必备 | ⚠️ 部分 | 验收资料/主体.docx | 缺少监理签字 |
| 3 | 装饰装修验收记录 | 🔴 高 | 必备 | ❌ 缺失 | - | 未找到该文档 |
| 4 | 检验批记录(基础) | 🔴 高 | 必备 | 🔧 需修复 | 验收资料/损坏.doc | 文档无法读取 |

### 二、材料资料

| 序号 | 资料名称 | 优先级 | 应有状态 | 实际状态 | 文件位置 | 问题描述 |
|------|---------|-------|---------|---------|---------|---------|
| 1 | 钢筋合格证 | 🟡 中 | 重要 | ✅ 完整 | 材料/钢筋/ | 10份,齐全 |
| 2 | 混凝土试验报告 | 🟡 中 | 重要 | ⚠️ 部分 | 材料/混凝土/ | 缺少部分批次 |

### 三、安全管理资料

| 序号 | 资料名称 | 优先级 | 应有状态 | 实际状态 | 文件位置 | 问题描述 |
|------|---------|-------|---------|---------|---------|---------|
| 1 | 安全检查记录 | 🟡 中 | 重要 | ✅ 完整 | 安全管理/ | 12次,完整 |
| 2 | 安全教育记录 | 🟡 中 | 重要 | ✅ 完整 | 安全管理/ | - |

---

## 🚨 问题分级列表

### 🔴 高优先级问题 (X 项) - 必须立即整改

#### 问题 1: 装饰装修验收记录缺失
- **资料类型**: 分部工程验收记录
- **问题描述**: 未找到装饰装修分部验收记录文档
- **影响**: 无法证明装饰装修工程已验收,影响竣工验收
- **整改建议**: 立即组织装饰装修分部验收,编制验收记录
- **整改期限**: 3天内
- **责任单位**: 施工单位、监理单位

#### 问题 2: 主体结构验收记录不完整
- **资料类型**: 分部工程验收记录
- **问题描述**: 验收记录存在但缺少监理单位签字
- **文档位置**: 验收资料/主体结构验收.docx
- **影响**: 验收记录不完整,不符合归档要求
- **整改建议**: 联系监理单位补充签字
- **整改期限**: 1周内
- **责任单位**: 监理单位

#### 问题 3: 检验批记录文档损坏
- **资料类型**: 检验批质量验收记录
- **问题描述**: 文档无法打开,可能已损坏
- **文档位置**: 验收资料/检验批-基础.doc
- **影响**: 关键验收数据无法读取
- **整改建议**: 从备份恢复或重新编制
- **整改期限**: 立即
- **责任单位**: 施工单位

### 🟡 中优先级问题 (Y 项) - 建议尽快整改

#### 问题 4: 混凝土试验报告不全
- **资料类型**: 材料复试报告
- **问题描述**: 缺少部分批次的试验报告
- **文档位置**: 材料/混凝土/试验报告/
- **影响**: 材料资料不完整
- **整改建议**: 从试验室获取缺失的报告
- **整改期限**: 2周内
- **责任单位**: 施工单位、试验室

### 🟢 低优先级问题 (Z 项) - 有时间时整改

#### 问题 5: 施工照片不足
- **资料类型**: 影像资料
- **问题描述**: 关键工序缺少施工照片
- **影响**: 影像资料不够丰富
- **整改建议**: 补充现场照片,注重关键工序
- **整改期限**: 1个月内
- **责任单位**: 施工单位

---

## 📊 统计汇总

### 资料完整性统计

```
总体情况:
- 应有资料: 50 项
- 实际拥有: 42 项
- 完全缺失: 8 项
- 资料完整率: 84%

状态分布:
- ✅ 完整: 35 项 (70%)
- ⚠️ 部分完整: 7 项 (14%)
- ❌ 缺失: 6 项 (12%)
- 🔧 需修复: 2 项 (4%)

问题级别:
- 🔴 高优先级: 3 项
- 🟡 中优先级: 5 项
- 🟢 低优先级: 4 项
```

### 按资料类型统计

| 资料类型 | 应有 | 实有 | 完整率 | 主要问题 |
|---------|------|------|--------|---------|
| 质量验收资料 | 20 | 16 | 80% | 3项缺失,1项不完整 |
| 材料资料 | 15 | 14 | 93% | 1项部分缺失 |
| 安全管理资料 | 8 | 8 | 100% | 无 |
| 技术资料 | 5 | 4 | 80% | 1项缺失 |
| 竣工资料 | 2 | 0 | 0% | 尚未开始编制 |

---

## 💡 整改建议

### 短期整改(1周内)

1. **立即补充缺失的必备资料**
   - 装饰装修验收记录
   - 检验批记录(修复损坏文档)

2. **完善签字手续**
   - 联系监理单位补充签字
   - 检查所有验收记录的签字完整性

3. **修复损坏文档**
   - 恢复备份或重新编制
   - 检查所有文档可读性

### 中期整改(2-4周)

1. **补充材料资料**
   - 从试验室获取缺失的试验报告
   - 完善材料进场记录

2. **完善技术资料**
   - 补充缺失的技术交底记录
   - 完善施工方案

### 长期改进

1. **建立资料管理制度**
   - 设专人负责资料收集整理
   - 定期检查资料完整性

2. **规范资料命名**
   - 统一文件命名规范
   - 使用规范的目录结构

3. **做好资料备份**
   - 定期备份重要资料
   - 防止文档丢失或损坏

---

## 📁 附录: 文档验证详情

### 成功验证的文档 (35 个)

1. 地基基础验收记录.docx - ✅ 验证通过,内容完整
2. 钢筋合格证001.pdf - ✅ 验证通过
3. 安全检查记录-20240901.xlsx - ✅ 验证通过
   [... 更多 ...]

### 验证失败的文档 (2 个)

1. 检验批-基础.doc - ❌ 文档损坏,无法打开
   - 建议: 从备份恢复或重新编制
2. 旧格式文件.xls - ⚠️ 旧格式,建议转换为 .xlsx

---

## 📋 报告说明

**数据来源**: 本报告基于原文档目录扫描和文档验证生成

**验证方式**:
- 文档存在性: Bash find 命令扫描
- 文档可读性: MCP mcp__construction_doc_processor__validate_document 工具验证
- 内容完整性: MCP parse 工具深度检查

**准确性说明**:
- ✅ 文档存在性: 100%准确
- ✅ 文档可读性: 100%准确
- ⚠️ 内容完整性: 基于自动分析,建议人工复核

**使用建议**:
1. 将本报告作为资料整改的依据
2. 按优先级逐项整改问题
3. 整改后重新运行检查验证
4. 定期(如每月)进行资料完整性检查

---

**生成时间**: [YYYY-MM-DD HH:MM:SS]
**生成工具**: 建筑施工文档助手 v1.1.0
**报告编号**: CHECK-[范围]-[时间戳]
```

### 9. 输出完成信息

```
✅ 资料完整性检查完成

📊 检查结果:
  - 检查范围: [全面检查/专项检查]
  - 应有资料: X 项
  - 实有资料: Y 项
  - 资料完整率: Z%

🚨 问题统计:
  - 🔴 高优先级: A 项 (必须立即整改)
  - 🟡 中优先级: B 项 (建议尽快整改)
  - 🟢 低优先级: C 项 (有时间时整改)

📄 报告位置:
  生成文件/分析报告/资料完整性检查-[范围]-20251014-154530.md

💡 关键问题:
  [列出前3个最严重的问题]
  1. 🔴 [问题描述]
  2. 🔴 [问题描述]
  3. 🟡 [问题描述]

✅ 下一步建议:
  1. 立即处理 [A] 个高优先级问题
  2. 制定整改计划,2周内处理中优先级问题
  3. 逐步完善低优先级问题
  4. 整改完成后重新运行检查
```

---

## 🔑 关键改进点总结

### 相比旧版本的改进

**改进前** (仅检查文件存在性):
- ❌ 只检查文件是否存在
- ❌ 无法判断文档是否可读
- ❌ 无法检查内容完整性
- ❌ 无法识别文档损坏

**改进后** (深度验证):
- ✅ 检查文件存在性
- ✅ 验证文档可读性(validate)
- ✅ 检查内容完整性(parse + 内容分析)
- ✅ 识别文档问题(损坏/格式错误/内容缺失)
- ✅ 分级问题管理
- ✅ 友好的整改建议

### 核心优势

1. **全面性**: 不仅检查存在性,还检查可用性和完整性
2. **准确性**: 使用MCP工具验证,准确识别文档问题
3. **实用性**: 提供分级问题列表和整改建议
4. **可追溯性**: 记录每个文档的验证结果
5. **专业性**: 符合建筑行业资料管理规范

---

**质量要求**:
- ✅ 检查全面,覆盖所有应有资料
- ✅ 问题分级准确,优先级明确
- ✅ 建议具体可行,便于执行
- ✅ 报告结构清晰,易于理解
