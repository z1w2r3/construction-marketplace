# 建筑施工资料整理方案生成

为指定资料类型生成专业的整理方案,包括分类结构、命名规范和执行步骤。

你现在要执行资料整理方案生成任务,资料类型: $ARGUMENTS

## 执行步骤

### 1. 验证参数

如果 $ARGUMENTS 为空,提示:
```
请指定资料类型,例如:
- /construction-organize 质量验收资料
- /construction-organize 安全管理资料
- /construction-organize 所有资料
```

### 2. 读取配置

从 `.claude/CLAUDE-construction.md` 获取:
- 项目名称
- 原文档目录路径
- 项目类型

使用 Read 工具读取配置文件。

### 3. 扫描并分析现有文档 ⭐ (核心改进)

#### 3.1 扫描文档目录

使用 Bash 工具列出所有文档:

```bash
# 统计不同类型文档数量
find "原文档目录" -type f -name "*.docx" | wc -l
find "原文档目录" -type f -name "*.xlsx" | wc -l
find "原文档目录" -type f -name "*.pdf" | wc -l

# 列出文档结构
find "原文档目录" -type d | head -20
find "原文档目录" -type f | head -50
```

#### 3.2 批量分析文档元数据 ⭐ (新增)

对扫描到的文档进行批量元数据分析:

```
使用 mcp__construction_doc_processor__get_document_metadata 工具:
- file_path: [每个文档路径]

获取信息:
- 文件名
- 文件大小
- 创建时间
- 修改时间
- 文件类型

目的:
1. 了解文档整体情况
2. 识别命名规律
3. 发现文件组织模式
4. 统计文档时间分布
```

**批量处理策略**:
```
由于文档可能很多,采用抽样分析:
- 每个目录抽取前10个文档
- 重点分析主要文档类型
- 记录命名规律和特点
```

### 4. 现状分析

根据扫描和分析结果,整理现状:

#### 4.1 文档规模统计

```
文档数量:
- Word 文档: X 个
- Excel 文档: Y 个
- PDF 文档: Z 个
- 其他文档: W 个
- 总计: N 个

文档容量:
- 总大小: XXX MB
- 平均大小: XX KB/个
- 最大文档: [文件名] (XX MB)
```

#### 4.2 当前组织方式分析

```
目录结构: [描述当前目录结构]
- 按时间组织
- 按工程阶段组织
- 混合组织
- 无明确组织

命名规范: [分析命名规律]
- 规范命名: X%
- 不规范命名: Y%
- 典型命名示例: [列举]
```

#### 4.3 存在的问题

```
主要问题:
1. 文档分类不清晰
2. 命名不规范
3. 目录层级过深/过浅
4. 缺少索引
5. 重复文档
6. 文件格式混乱
```

### 5. 生成整理方案

#### 5.1 推荐分类结构

根据资料类型和项目特点,设计树形结构:

**示例: 质量验收资料整理结构**

```
质量验收资料/
├── 01-地基基础/
│   ├── 检验批/
│   │   ├── 土方工程/
│   │   ├── 地基处理/
│   │   └── 桩基工程/
│   ├── 分项工程/
│   └── 分部工程/
│       └── 地基基础分部验收记录.docx
│
├── 02-主体结构/
│   ├── 检验批/
│   │   ├── 模板工程/
│   │   ├── 钢筋工程/
│   │   ├── 混凝土工程/
│   │   └── 砌体工程/
│   ├── 分项工程/
│   └── 分部工程/
│       └── 主体结构分部验收记录.docx
│
├── 03-装饰装修/
│   ├── 检验批/
│   ├── 分项工程/
│   └── 分部工程/
│
├── 04-屋面工程/
│   └── ...
│
├── 05-给排水/
│   └── ...
│
└── 索引文件.xlsx
```

#### 5.2 文件命名规范

**命名格式**:
```
[分部编号]-[分项名称]-[检验批编号]-[施工部位]-[日期].docx

示例:
- 01-混凝土-001-1F柱-20240915.docx
- 02-钢筋-005-2F梁-20240920.docx

命名要求:
1. 使用中文或拼音,避免特殊字符
2. 包含关键信息:部位、编号、日期
3. 统一日期格式: YYYYMMDD
4. 避免过长文件名(<50字符)
```

#### 5.3 详细整理清单

创建整理清单表格:

```markdown
| 序号 | 原路径 | 新路径 | 新文件名 | 备注 |
|------|--------|--------|---------|------|
| 1 | /原始/验收.docx | /质量验收/01-地基/分部工程/ | 地基基础分部验收-20240915.docx | - |
| 2 | /原始/检查.xlsx | /质量验收/02-主体/检验批/混凝土/ | 02-混凝土-001-1F柱-20240920.xlsx | - |
| ... | ... | ... | ... | ... |
```

### 6. 执行步骤规划

#### 6.1 准备阶段(1-2天)

```
1. 创建新的目录结构
   mkdir -p 质量验收资料/01-地基基础/检验批/...

2. 备份原文档
   cp -r 原文档目录 原文档目录_backup_YYYYMMDD

3. 制定详细整理计划
   - 分配任务
   - 确定时间表
```

#### 6.2 整理阶段(3-5天)

```
1. 按分类整理文档
   - 先整理分部工程资料
   - 再整理检验批资料
   - 最后整理其他资料

2. 重命名文档
   - 按命名规范统一重命名
   - 保留原文件名信息

3. 建立索引
   - 创建Excel索引文件
   - 记录文档位置和关键信息
```

#### 6.3 验证阶段(1天)

```
1. 检查完整性
   - 确认所有文档已整理
   - 检查无遗漏

2. 抽查质量
   - 随机抽查10%文档
   - 验证分类和命名正确性

3. 验收确认
   - 组织验收
   - 形成验收记录
```

### 7. 质量控制要点

```
控制点:
1. 不删除原文档,先复制再整理
2. 保持文档内容完整性
3. 统一命名规范
4. 及时建立索引
5. 定期备份

检查清单:
- [ ] 原文档已备份
- [ ] 新目录结构已建立
- [ ] 文档分类正确
- [ ] 命名规范统一
- [ ] 索引文件已创建
- [ ] 抽查验证通过
```

### 8. 工作量评估

```
人员需求:
- 主要负责人: 1人(资料员)
- 协助人员: 1-2人

时间评估:
- 准备阶段: 1-2天
- 整理阶段: 3-5天
- 验证阶段: 1天
- 总计: 5-8个工作日

影响因素:
- 文档数量: [N]个 → 预计[X]天
- 文档复杂度: [简单/中等/复杂]
- 人员熟练度: [新手/熟练/专家]

建议:
- 文档<500个: 5天
- 文档500-1000个: 8天
- 文档>1000个: 10-15天
```

### 9. 保存方案

使用 Write 工具保存到:
```
生成文件/整理方案/[资料类型]-整理方案-YYYYMMDD-HHMMSS.md
```

### 10. 输出完成信息

```
✅ 资料整理方案生成完成

📊 现状分析:
  - 文档总数: X 个
  - 当前组织: [描述]
  - 主要问题: [列出3个主要问题]

📋 方案概要:
  - 推荐结构: [X]级目录
  - 分类数量: [Y]个分类
  - 命名规范: 已制定

⏱️ 工作量评估:
  - 预计时间: X-Y 天
  - 建议人员: Z 人

📄 方案位置:
  生成文件/整理方案/质量验收资料-整理方案-20251014-160530.md

⚠️ 重要提示:
  1. 本方案仅供参考,执行前请备份原文档
  2. 建议先小范围试点,再全面推广
  3. 不要直接移动原文档,建议复制后整理
  4. 执行过程中注意保护文档完整性

✅ 下一步建议:
  1. 审核整理方案
  2. 制定详细执行计划
  3. 组织培训和动员
  4. 开始试点整理
```

---

## 🔑 关键改进点总结

### 相比旧版本的改进

**改进前**:
- ❌ 只基于目录扫描分析
- ❌ 无法了解文档详细信息
- ❌ 整理方案较粗糙

**改进后**:
- ✅ 使用 MCP 工具获取文档元数据
- ✅ 深入分析文档命名和组织规律
- ✅ 提供详细的整理清单和执行步骤
- ✅ 准确的工作量评估
- ✅ 完善的质量控制机制

### 核心优势

1. **数据驱动**: 基于真实文档元数据制定方案
2. **可执行性**: 提供详细的执行步骤和清单
3. **可控性**: 完善的质量控制和验证机制
4. **安全性**: 强调备份和保护原文档

---

⚠️ **重要**: 此命令只生成方案,不实际移动或修改文件。所有文件操作需人工执行。
