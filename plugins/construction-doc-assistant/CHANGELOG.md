# 更新日志

所有重要的项目变更都会记录在这个文件中。

本项目遵循 [语义化版本](https://semver.org/) 规范。

---

## [1.1.0] - 2025-10-14

### 🎉 重大更新

**核心升级**: 完全重写4个核心命令文件,使用新的 MCP docxtpl 工具,彻底解决Office文档读取失败问题。

### ✨ 命令文件全面升级

#### 1. construction-summary.md - 项目总结生成
- ✅ 使用 MCP 工具验证和解析文档(validate + parse)
- ✅ 支持 Word、Excel、PDF 三种格式完整解析
- ✅ 智能建筑关键词提取(进度、质量、安全、成本)
- ✅ 文档读取状态追踪(成功/部分/失败)
- ✅ 友好的容错处理机制(多级回退)

#### 2. construction-check.md - 资料完整性检查
- ✅ 文档可读性自动验证
- ✅ 内容完整性深度检查(签字、日期、必要章节)
- ✅ 分级问题管理(🔴高/🟡中/🟢低)
- ✅ 详细的整改建议和期限
- ✅ 文档验证详情完整追踪

#### 3. construction-organize.md - 整理方案生成
- ✅ 批量文档元数据分析
- ✅ 命名规律自动识别
- ✅ 详细的整理清单表格
- ✅ 准确的工作量评估(人员、时间)
- ✅ 完善的质量控制检查清单

#### 4. construction-progress.md - 进度分析
- ✅ 自动提取进度关键词(计划/实际/偏差)
- ✅ 自动计算进度偏差百分比
- ✅ 风险分级评估(🟢低/🟡中/🔴高)
- ✅ 分级建议措施(短期/中期/赶工)
- ✅ 数据来源完整追溯

### 🔧 核心改进

#### 文档处理能力提升

**改进前** (使用 Read 工具):
- ❌ Excel 文档经常失败
- ❌ 单个文档失败导致流程中断
- ❌ 没有错误提示和建议

**改进后** (使用 MCP docxtpl 工具):
- ✅ Word (.docx)、Excel (.xlsx)、PDF (.pdf) 完整支持
- ✅ 文档验证机制,提前发现问题
- ✅ 智能容错,单个失败不影响整体
- ✅ 友好的错误提示和建议
- ✅ 建筑行业关键词智能提取
- ✅ 完整的文档读取状态追踪

#### 智能化提升

1. **建筑关键词库**
   - 进度: "计划完成"、"实际完成"、"工期"、"延期"
   - 质量: "验收"、"合格"、"不合格"、"整改"
   - 安全: "安全检查"、"隐患"、"事故"
   - 成本: "造价"、"成本"、"费用"、"预算"

2. **智能信息提取**
   - 自动筛选包含关键词的段落
   - 自动提取表格数据
   - 自动记录信息来源和页码

3. **多级容错机制**
   - 验证 → 解析 → 元数据 → 友好提示
   - 不中断整体流程

#### 报告质量提升

1. **文档读取状态表**
   ```
   | 文档 | 状态 | 提取内容 |
   | ✅ 成功 | ⚠️ 部分 | ❌ 失败 |
   ```

2. **数据来源追溯**
   - 每条信息标注来源文档
   - 记录完整文档路径
   - 便于人工复核验证

### 📦 MCP 工具集成

- ✅ mcp__docxtpl__validate_document - 验证文档可读性
- ✅ mcp__docxtpl__parse_docx_document - 解析 Word 文档
- ✅ mcp__docxtpl__parse_excel_document - 解析 Excel 文档
- ✅ mcp__docxtpl__parse_pdf_document - 解析 PDF 文档
- ✅ mcp__docxtpl__get_document_metadata - 获取文档元数据

### 🐛 Bug 修复

1. **文档读取问题**
   - ✅ 修复 Excel 文档读取失败
   - ✅ 修复文档验证不准确
   - ✅ 修复单个文档失败导致整体中断

2. **流程稳定性**
   - ✅ 修复错误提示不清晰
   - ✅ 修复批量处理效率低
   - ✅ 改进容错机制

### 📝 文档更新

1. **命令文件文档**
   - 详细的 MCP 工具使用说明
   - 完整的执行步骤描述
   - 清晰的改进点总结

2. **实施指南**
   - 创建《剩余工作实施指南.md》
   - 详细的升级方案
   - 完整的测试指南

### ⚠️ 已知问题

1. **文档格式支持**
   - 旧版 Office 文档 (.doc, .xls) 支持有限
   - 建议转换为新格式

2. **大文件处理**
   - 文件 >100MB 可能较慢
   - 建议分批处理

### 💡 使用建议

1. 优先使用新版 Office 格式 (.docx, .xlsx)
2. 先运行 /construction-init 初始化
3. 使用 /construction-summary 测试功能
4. 查看错误提示,按建议操作

### 🔄 升级说明

从 v1.0.0 升级到 v1.1.0:
- 已有配置文件保持不变
- 已生成报告保持不变
- 新功能立即可用

---

## [1.0.0] - 2024-10-13

### 新增
- 🎉 首次发布
- ✅ 8个核心命令实现
  - `/construction-init` - 项目初始化
  - `/construction-index` - 文档索引生成
  - `/construction-check` - 资料完整性检查
  - `/construction-search` - 文档内容搜索
  - `/construction-organize` - 整理方案生成
  - `/construction-summary` - 项目总结生成
  - `/construction-progress` - 项目进度分析
  - `/construction-help` - 帮助文档
- 🐍 Python MCP 服务器实现
  - Word 文档解析
  - Excel 文档解析
  - PDF 文档解析
  - 文档元数据获取
- 📚 完整的项目文档
- 🔧 Claude Code 插件配置
- 📦 GitHub Marketplace 支持

### 功能特性
- 非侵入式设计,只读访问原文档
- AI 驱动的文档理解和分析
- 符合建筑行业规范的输出格式
- 支持3种项目类型(通用/房建/市政)

### 技术架构
- Claude Code 插件系统
- MCP (Model Context Protocol) 集成
- Python 文档处理工具链
- Markdown 命令配置

### 文档
- README.md - 项目说明
- CLAUDE.md - 开发指南
- PRD.md - 产品需求文档
- 完整的命令文档
- Python MCP 服务器文档

## [未来计划]

### v1.1.0
- [ ] 支持更多文档格式
- [ ] 批量处理多个项目
- [ ] 导出功能(PDF、Word)
- [ ] 自定义检查规则
- [ ] 模板管理系统

### v2.0.0
- [ ] 可视化仪表板
- [ ] 多人协作功能
- [ ] 数据分析和趋势预测
- [ ] 移动端支持

---

**版本号说明**:
- **主版本号(Major)**: 不兼容的 API 变更
- **次版本号(Minor)**: 向下兼容的功能新增
- **修订号(Patch)**: 向下兼容的问题修正
